import{_ as d,q as u,o as m,c as p,a,t as c,i as r,v as o,s as h}from"./index-1eimlCe9.js";const f={name:"UserRegister",props:[""],data(){return{username:"",password:"",password2:"",mobile:"",message:""}},watch:{username(s){s&&(this.cancelRequest(),this.axios.get("/user/"+s,{cancelToken:new this.axios.CancelToken(e=>this.cancel=e)}).then(e=>{e.data.code==200&&(e.data.data?this.message="该用户名已经存在":this.message="该用户名可用")}).catch(e=>{this.axios.isCancel(e)?console.log("请求取消：",e.message):console.log(e)}))}},methods:{register(){this.message="",this.checkForm()&&this.axios.post("/user/register",{username:this.username,password:this.password,mobile:this.mobile}).then(s=>{if(s.data.code===200){var e={username:s.data.data.userName,id:s.data.data.userId};this.saveUser(e),this.username="",this.password="",this.password2="",this.mobile="",this.$router.push("/")}else s.data.code===500&&(this.message="用户注册失败")}).catch(s=>{alert(s.message)})},cancelRequest(){typeof this.cancel=="function"&&this.cancel("终止请求")},checkForm(){return!this.username||!this.password||!this.password2||!this.mobile?(alert("所有字段不能为空"),!1):this.password!==this.password2?(alert("密码和确认密码必须相同"),!1):!0},...u("user",["saveUser"])}},g={class:"register"},w={class:"lable"},v={class:"error"},b={class:"submit"};function x(s,e,n,_,t,l){return m(),p("div",g,[a("form",null,[a("div",w,[a("label",v,c(t.message),1),r(a("input",{name:"username",type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>t.username=i),placeholder:"请输入用户名"},null,512),[[o,t.username]]),r(a("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=i=>t.password=i),placeholder:"请输入密码"},null,512),[[o,t.password,void 0,{trim:!0}]]),r(a("input",{type:"password","onUpdate:modelValue":e[2]||(e[2]=i=>t.password2=i),placeholder:"请输入确认密码"},null,512),[[o,t.password2,void 0,{trim:!0}]]),r(a("input",{type:"tel","onUpdate:modelValue":e[3]||(e[3]=i=>t.mobile=i),placeholder:"请输入手机号"},null,512),[[o,t.mobile,void 0,{trim:!0}]])]),a("div",b,[a("input",{type:"submit",onClick:e[4]||(e[4]=h((...i)=>l.register&&l.register(...i),["prevent"])),value:"注册"})])])])}const k=d(f,[["render",x],["__scopeId","data-v-93164dbb"]]);export{k as default};
